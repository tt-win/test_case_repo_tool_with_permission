[request_definition]
r = sub, obj, act, dom, ctx

[policy_definition]
p = sub, obj, act, dom

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# RBAC + 資源範疇（domain/team）
# 允許兩種方式匹配主體：
# 1) 直接以角色名稱比對（r.sub == p.sub）
# 2) 傳統 RBAC 關聯（g(r.sub, p.sub)）
# 先以 RBAC 放行，再由後端執行 constraints 檢查
m = (r.sub == p.sub || g(r.sub, p.sub)) && keyMatch2(r.obj, p.obj) && regexMatch(r.act, p.act) && (regexMatch(p.dom, "^\\s*$") || r.dom == p.dom)
